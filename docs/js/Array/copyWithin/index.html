<h1>Array.prototype.copyWithin()</h1><div><div></div></div><h2 id="summary"><a href="#summary" title="Permalink to Сводка">Сводка</a></h2><div><p>Метод <code><strong>copyWithin()</strong></code> копирует последовательность элементов массива внутри него в позицию, начинающуюся по индексу <code>target</code>. Копия берётся по индексам, задаваемым вторым и третьим аргументами <code>start</code> и <code>end</code>. Аргумент <code>end</code> является необязательным и по умолчанию равен длине массива.</p></div><h2 id="syntax"><a href="#syntax" title="Permalink to Синтаксис">Синтаксис</a></h2><div><pre class="syntaxbox notranslate"><code><var>arr</var>.copyWithin(<var>target</var>, <var>start</var>[, <var>end</var> = this.length])</code></pre></div><h3 id="parameters"><a href="#parameters" title="Permalink to Параметры">Параметры</a></h3><div><dl>
 <dt><code>target</code></dt>
 <dd>Начальный индекс позиции цели, куда копировать элементы.</dd>
 <dt><code>start</code></dt>
 <dd>Начальный индекс позиции источника, откуда начинать копировать элементы.</dd>
 <dt><code>end</code></dt>
 <dd>Необязательный параметр. Конечный индекс позиции источника, где заканчивать копировать элементы.</dd>
</dl></div><h2 id="description"><a href="#description" title="Permalink to Описание">Описание</a></h2><div><p>Аргументы <code>target</code>, <code>start</code> и <code>end</code> приводятся к <a href="/js/Number/"><code>Number</code></a> и обрезаются до целых значений.</p>

<p>Если аргумент <code>start</code> является отрицательным, он трактуется как <code>length+start</code> где <code>length</code>&nbsp;— это длина массива. Если аргумент <code>end</code> является отрицательным, он трактуется как <code>length+end</code>.</p>

<p>Функция <code>copyWithin</code> намеренно является <em>обобщённой</em>, она не требует, чтобы значение <code>this</code> внутри неё было объектом <a href="/js/Array/"><code>Array</code></a>, и кроме того, функция <code>copyWithin</code> является <em>изменяющим методом</em>, она изменит объект <code>this</code> и вернёт его, а не просто вернёт копию.</p></div><h2 id="examples"><a href="#examples" title="Permalink to Примеры">Примеры</a></h2><div><pre class="brush: js notranslate"><code><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [4, 5, 3, 4, 5]</span>

<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [4, 2, 3, 4, 5]</span>

<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// [4, 2, 3, 4, 5]</span>

<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">{</span>length<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// {0: 1, 3: 1, length: 5}</span>

<span class="token comment">// Типизированные массивы ES6 являются подклассами Array</span>
<span class="token keyword">var</span> i32a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Int32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

i32a<span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Int32Array [3, 4, 5, 4, 5]</span>

<span class="token comment">// На платформах, которые ещё не совместимы с ES6:</span>
<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">copyWithin</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Int32Array</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// Int32Array [4, 2, 3, 4, 5]</span>
</code></pre></div><h2 id="polyfill"><a href="#polyfill" title="Permalink to Полифил">Полифил</a></h2><div><pre class="brush: js notranslate"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>copyWithin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">Array</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">copyWithin</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> start<span class="token comment">/*, end*/</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Шаги 1-2.</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'this is null or not defined'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> <span class="token constant">O</span> <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаги 3-5.</span>
    <span class="token keyword">var</span> len <span class="token operator">=</span> <span class="token constant">O</span><span class="token punctuation">.</span>length <span class="token operator">&gt;&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаги 6-8.</span>
    <span class="token keyword">var</span> relativeTarget <span class="token operator">=</span> target <span class="token operator">&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> to <span class="token operator">=</span> relativeTarget <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span>
      Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>len <span class="token operator">+</span> relativeTarget<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span>
      Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>relativeTarget<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаги 9-11.</span>
    <span class="token keyword">var</span> relativeStart <span class="token operator">=</span> start <span class="token operator">&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> <span class="token keyword">from</span> <span class="token operator">=</span> relativeStart <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span>
      Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>len <span class="token operator">+</span> relativeStart<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span>
      Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>relativeStart<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаги 12-14.</span>
    <span class="token keyword">var</span> end <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> relativeEnd <span class="token operator">=</span> end <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> len <span class="token operator">:</span> end <span class="token operator">&gt;&gt;</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> final <span class="token operator">=</span> relativeEnd <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span>
      Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>len <span class="token operator">+</span> relativeEnd<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span>
      Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>relativeEnd<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаг 15.</span>
    <span class="token keyword">var</span> count <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>final <span class="token operator">-</span> <span class="token keyword">from</span><span class="token punctuation">,</span> len <span class="token operator">-</span> to<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Шаги 16-17.</span>
    <span class="token keyword">var</span> direction <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token operator">&lt;</span> to <span class="token operator">&amp;&amp;</span> to <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token operator">+</span> count<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      direction <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">from</span> <span class="token operator">+=</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
      to <span class="token operator">+=</span> count <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Шаг 18</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>count <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">from</span> <span class="token keyword">in</span> <span class="token constant">O</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token constant">O</span><span class="token punctuation">[</span>to<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token constant">O</span><span class="token punctuation">[</span><span class="token keyword">from</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">delete</span> <span class="token constant">O</span><span class="token punctuation">[</span>to<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">from</span> <span class="token operator">+=</span> direction<span class="token punctuation">;</span>
      to <span class="token operator">+=</span> direction<span class="token punctuation">;</span>
      count<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// Шаг 19.</span>
    <span class="token keyword">return</span> <span class="token constant">O</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="specifications"><a href="#specifications" title="Permalink to Спецификации">Спецификации</a></h2><div><table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Спецификация</th>
   <th scope="col">Статус</th>
   <th scope="col">Комментарии</th>
  </tr>
  <tr>
   <td><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-array.prototype.copyWithin" hreflang="en" lang="en" class="external" rel=" noopener">ECMAScript 2015 (6th Edition, ECMA-262)<br><small lang="ru">Определение 'Array.prototype.copyWithin' в этой спецификации.</small></a></td>
   <td><span class="spec-standard">Стандарт</span></td>
   <td>Изначальное определение.</td>
  </tr>
  <tr>
   <td><a href="https://tc39.es/ecma262/#sec-array.prototype.copyWithin" hreflang="en" lang="en" class="external" rel=" noopener">ECMAScript (ECMA-262)<br><small lang="ru">Определение 'Array.prototype.copyWithin' в этой спецификации.</small></a></td>
   <td><span class="spec-living">Живой стандарт</span></td>
   <td>&nbsp;</td>
  </tr>
 </tbody>
</table></div><h2 id="browser_compatibility"><a href="#browser_compatibility" title="Permalink to Совместимость с браузерами">Совместимость с браузерами</a></h2><p>BCD tables only load in the browser</p><div><p></p><p></p></div><h2 id="see_also"><a href="#see_also" title="Permalink to Смотрите также">Смотрите также</a></h2><div><ul>
 <li><a href="/js/Array/"><code>Array</code></a></li>
</ul></div>