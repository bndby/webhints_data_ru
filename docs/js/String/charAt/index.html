<h1>String.prototype.charAt()</h1><div><div></div></div><h2 id="summary"><a href="#summary" title="Permalink to Сводка">Сводка</a></h2><div><p>Метод <strong><code>charAt()</code></strong> возвращает указанный символ из строки.</p></div><h2 id="syntax"><a href="#syntax" title="Permalink to Синтаксис">Синтаксис</a></h2><div><pre class="syntaxbox notranslate"><code><var>str</var>.charAt(<var>index</var>)</code></pre></div><h3 id="parameters"><a href="#parameters" title="Permalink to Параметры">Параметры</a></h3><div><dl>
 <dt><code>index</code></dt>
 <dd>Целое число от 0 до длины строки минус 1.</dd>
</dl></div><h2 id="description"><a href="#description" title="Permalink to Описание">Описание</a></h2><div><p>Символы в строке идут слева направо. Индекс первого символа равен 0, а последнего символа в строке <code>stringName</code> равен <code>stringName.length - 1</code>. Если предоставленный вами параметр <code>index</code> выходит за пределы этого диапазона, JavaScript вернёт пустую строку.</p></div><h2 id="examples"><a href="#examples" title="Permalink to Примеры">Примеры</a></h2><div></div><h3 id="example_displaying_characters_at_different_locations_in_a_string"><a href="#example_displaying_characters_at_different_locations_in_a_string" title="Permalink to Пример: отображение символов из различных позиций строки">Пример: отображение символов из различных позиций строки</a></h3><div><p>Следующий пример показывает символы в различных позициях в строке <code>"Дивный новый мир"</code>:</p>
<pre class="brush: js notranslate"><code><span class="token keyword">var</span> anyString <span class="token operator">=</span> <span class="token string">'Дивный новый мир'</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 0   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 1   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 2   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 3   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 4   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 5   равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>   <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Символ по индексу 999 равен '"</span> <span class="token operator">+</span> anyString<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Этот код отобразит следующее:</p>
<pre class="brush: js notranslate"><code>Символ по индексу <span class="token number">0</span>   равен <span class="token string">'Д'</span>
Символ по индексу <span class="token number">1</span>   равен <span class="token string">'и'</span>
Символ по индексу <span class="token number">2</span>   равен <span class="token string">'в'</span>
Символ по индексу <span class="token number">3</span>   равен <span class="token string">'н'</span>
Символ по индексу <span class="token number">4</span>   равен <span class="token string">'ы'</span>
Символ по индексу <span class="token number">5</span>   равен <span class="token string">'й'</span>
Символ по индексу <span class="token number">999</span> равен <span class="token string">''</span>
</code></pre></div><h3 id="example_getting_whole_characters"><a href="#example_getting_whole_characters" title="Permalink to Пример: получение целых символов">Пример: получение целых символов</a></h3><div><p>Следующий пример показывает, как обойти строку в цикле, каждый раз гарантированно получая целый символ, даже если строка содержит символы, не помещающиеся на Базовую многоязыковую плоскость (БМП).</p>
<pre class="brush: js notranslate"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'A \uD87E\uDC04 Z'</span><span class="token punctuation">;</span> <span class="token comment">// Также можно использовать не-БМП символы напрямую</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> chr<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>chr <span class="token operator">=</span> <span class="token function">getWholeChar</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">continue</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Поместите эти строки в самое начало каждого цикла, передавая в функцию строку</span>
  <span class="token comment">// и текущую итерацию; возвращаемая переменная будут представлять</span>
  <span class="token comment">// отдельный символ</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getWholeChar</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> code <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// Позиция не найдена</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">&lt;</span> <span class="token number">0xD800</span> <span class="token operator">||</span> code <span class="token operator">&gt;</span> <span class="token number">0xDFFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Старшая часть суррогатной пары (последнее число можно изменить на 0xDB7F,</span>
  <span class="token comment">// чтобы трактовать старшую часть суррогатной пары в частной плоскости как</span>
  <span class="token comment">// одиночный символ)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xD800</span> <span class="token operator">&lt;=</span> code <span class="token operator">&amp;&amp;</span> code <span class="token operator">&lt;=</span> <span class="token number">0xDBFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token string">'Старшая часть суррогатной пары без следующей младшей'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> next <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xDC00</span> <span class="token operator">&gt;</span> next <span class="token operator">||</span> next <span class="token operator">&gt;</span> <span class="token number">0xDFFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token string">'Старшая часть суррогатной пары без следующей младшей'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Младшая часть суррогатной пары (0xDC00 &lt;= code &amp;&amp; code &lt;= 0xDFFF)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'Младшая часть суррогатной пары без предшествующей старшей'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> prev <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// (последнее число можно изменить на 0xDB7F, чтобы трактовать старшую</span>
  <span class="token comment">// часть суррогатной пары в частной плоскости как одиночный символ)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xD800</span> <span class="token operator">&gt;</span> prev <span class="token operator">||</span> prev <span class="token operator">&gt;</span> <span class="token number">0xDBFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'Младшая часть суррогатной пары без предшествующей старшей'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Теперь мы можем пропустить младшую часть суррогатной пары,</span>
  <span class="token comment">// которую мы уже обработали</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>В среде, поддерживающей JavaScript 1.7+ (например, в Firefox), который позволяет деструктурирующее присваивание, можно использовать более лаконичную и более гибкую альтернативу в том смысле, что она автоматически увеличивает счётчик (если символ гарантированно является суррогатной парой).</p>
<pre class="brush: js notranslate"><code><span class="token keyword">var</span> str <span class="token operator">=</span> <span class="token string">'A\uD87E\uDC04Z'</span><span class="token punctuation">;</span> <span class="token comment">// Также можно использовать не-БМП символы напрямую</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> chr<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>chr<span class="token punctuation">,</span> i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">getWholeCharAndI</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// Поместите эту строку в самое начало каждого цикла, передавая в функцию строку</span>
  <span class="token comment">// и текущую итерацию; возвращаемый массив будет содержать отдельный символ и</span>
  <span class="token comment">// новое значение счётчика цикла 'i' (изменится только при встрече суррогатной пары)</span>

  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>chr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">getWholeCharAndI</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> code <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// Позиция не найдена</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">&lt;</span> <span class="token number">0xD800</span> <span class="token operator">||</span> code <span class="token operator">&gt;</span> <span class="token number">0xDFFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// Обычный символ, оставляем переменную 'i' неизменной</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// Старшая часть суррогатной пары (последнее число можно изменить на 0xDB7F,</span>
  <span class="token comment">// чтобы трактовать старшую часть суррогатной пары в частной плоскости как</span>
  <span class="token comment">// одиночный символ)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xD800</span> <span class="token operator">&lt;=</span> code <span class="token operator">&amp;&amp;</span> code <span class="token operator">&lt;=</span> <span class="token number">0xDBFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>str<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token string">'Старшая часть суррогатной пары без следующей младшей'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">var</span> next <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xDC00</span> <span class="token operator">&gt;</span> next <span class="token operator">||</span> next <span class="token operator">&gt;</span> <span class="token number">0xDFFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token string">'Старшая часть суррогатной пары без следующей младшей'</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Младшая часть суррогатной пары (0xDC00 &lt;= code &amp;&amp; code &lt;= 0xDFFF)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'Младшая часть суррогатной пары без предшествующей старшей'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">var</span> prev <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// (последнее число можно изменить на 0xDB7F, чтобы трактовать старшую</span>
  <span class="token comment">// часть суррогатной пары в частной плоскости как одиночный символ)</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0xD800</span> <span class="token operator">&gt;</span> prev <span class="token operator">||</span> prev <span class="token operator">&gt;</span> <span class="token number">0xDBFF</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">throw</span> <span class="token string">'Младшая часть суррогатной пары без предшествующей старшей'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Возвращаем следующий символ (и увеличиваем счётчик)</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="example_fixing_charat_to_support_non-basic-multilingual-plane_bmp_characters"><a href="#example_fixing_charat_to_support_non-basic-multilingual-plane_bmp_characters" title="Permalink to Пример: добавление к методу charAt() поддержки символов не в Базовой многоязыковой плоскости (БМП)">Пример: добавление к методу <code>charAt()</code> поддержки символов не в Базовой многоязыковой плоскости (БМП)</a></h3><div><p>В то время как пример выше может быть более полезен тем, кто хочет поддерживать символы не в плоскости БМП (поскольку он не требует от вызывающей стороны знания о том, где может встретиться символ из не-БМП), в случае, если кто-то желает <em>выбирать</em> символы по индексу и трактовать суррогатную пару внутри строки как один символ, он может использовать следующий код:</p>
<pre class="brush: js notranslate"><code><span class="token keyword">function</span> <span class="token function">fixedCharAt</span><span class="token punctuation">(</span><span class="token parameter">str<span class="token punctuation">,</span> idx</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> ret <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  str <span class="token operator">+=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> end <span class="token operator">=</span> str<span class="token punctuation">.</span>length<span class="token punctuation">;</span>

  <span class="token keyword">var</span> surrogatePairs <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\uD800-\uDBFF][\uDC00-\uDFFF]</span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">;</span>
  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>surrogatePairs<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> li <span class="token operator">=</span> surrogatePairs<span class="token punctuation">.</span>lastIndex<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>li <span class="token operator">-</span> <span class="token number">2</span> <span class="token operator">&lt;</span> idx<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      idx<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>idx <span class="token operator">&gt;=</span> end <span class="token operator">||</span> idx <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  ret <span class="token operator">+=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>idx<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\uD800-\uDBFF]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>ret<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">[\uDC00-\uDFFF]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Перешагиваем через один, поскольку один «символ» является частью суррогатной пары</span>
    ret <span class="token operator">+=</span> str<span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> ret<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="specifications"><a href="#specifications" title="Permalink to Спецификации">Спецификации</a></h2><div><table class="standard-table">
 <tbody>
  <tr>
   <th scope="col">Спецификация</th>
   <th scope="col">Статус</th>
   <th scope="col">Комментарии</th>
  </tr>
  <tr>
   <td>ECMAScript 1-е издание.</td>
   <td>Стандарт</td>
   <td>Изначальное определение.</td>
  </tr>
  <tr>
   <td><a href="https://www.ecma-international.org/ecma-262/5.1/#sec-15.5.4.4" hreflang="en" lang="en" class="external" rel=" noopener">ECMAScript 5.1 (ECMA-262)<br><small lang="ru">Определение 'String.prototype.charAt' в этой спецификации.</small></a></td>
   <td><span class="spec-standard">Стандарт</span></td>
   <td>&nbsp;</td>
  </tr>
  <tr>
   <td><a href="https://www.ecma-international.org/ecma-262/6.0/#sec-string.prototype.charat" hreflang="en" lang="en" class="external" rel=" noopener">ECMAScript 2015 (6th Edition, ECMA-262)<br><small lang="ru">Определение 'String.prototype.charAt' в этой спецификации.</small></a></td>
   <td><span class="spec-standard">Стандарт</span></td>
   <td>&nbsp;</td>
  </tr>
 </tbody>
</table></div><h2 id="browser_compatibility"><a href="#browser_compatibility" title="Permalink to Совместимость с браузерами">Совместимость с браузерами</a></h2><p>BCD tables only load in the browser</p><div><p></p><p></p></div><h2 id="see_also"><a href="#see_also" title="Permalink to Смотрите также">Смотрите также</a></h2><div><ul>
 <li><a href="/js/String/indexOf/"><code>String.prototype.indexOf()</code></a></li>
 <li><a href="/js/String/lastIndexOf/"><code>String.prototype.lastIndexOf()</code></a></li>
 <li><a href="/js/String/charCodeAt/"><code>String.prototype.charCodeAt()</code></a></li>
 <li><a href="/js/String/codePointAt/"><code>String.prototype.codePointAt()</code></a></li>
 <li><a href="/js/String/split/"><code>String.prototype.split()</code></a></li>
 <li><a href="/js/String/fromCodePoint/"><code>String.fromCodePoint()</code></a></li>
</ul></div>